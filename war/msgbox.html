<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ripples - Message Box</title>
<script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
<script type='text/javascript' src='js/jquery.msgBox.js'></script>
<link rel="stylesheet" href="css/msgBoxLight.css" />
<script type="text/javascript">
	$(document).ready(
					function() {
						var d = new Date();
						var month = d.getMonth() + 1;
						var day = d.getDate();
						var date = d.getFullYear() + '-'
								+ (month < 10 ? '0' : '') + month + '-'
								+ (day < 10 ? '0' : '') + day;
						var path = "/logbook/" + date;
						$.ajax({
									type : 'HEAD',
									url : path,
									success : function() {
										//alert("The logbook for this date " + date + " exists.");
										//$("#log_view").attr('src', path);
										$('#log_view', window.parent.document).hide();
										$.getJSON( path+'.json', function( data ) {
											var items = [];
											$.each( data, function( key, val ) {
											items.push( "<li id='" + key + "'>"+key+": "+ val + "</li>" );
											});
											$( "<ul/>", {
											"class": "log_list",
											html: items.join( "" )
											}).appendTo( "body" );
											});
									},
									error : function() {
										//alert("The logbook for this date "+ date +" needs to be created.");
										$.msgBox({
													title : "Are You Sure",
													content : "Would you like to create a logobook for today?",
													type : "confirm",
													buttons : [ {
														value : "Yes"
													}, {
														value : "No"
													}, {
														value : "Cancel"
													} ],
													success : function(result) {
														if (result == "Yes") {
															var newpath = '/logbook/create';
															$('#log_view', window.parent.document).show();
															$("#log_view").attr('src', newpath);
															alert("Logbook created.");
															$('#log_view', window.parent.document).hide();
														} else {
															//$("#log_view").attr('src', '/logbook/');
															$('#log_view', window.parent.document).hide();
														}
													}
												});
									}
								});
					});
</script>
</head>
<body>
	<h1>Logbook for today:</h1>
	<iframe id="log_view" style="display:none;"></iframe>
</body>
</html>